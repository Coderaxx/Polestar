<form class="homey-form" id="loginForm">
    <fieldset class="homey-form-fieldset">
        <legend class="homey-form-legend">Login</legend>

        <div class="homey-form-group">
            <label class="homey-form-label" for="email">Epost</label>
            <input class="homey-form-input" id="email" type="text" value="" />
        </div>
        <div class="homey-form-group">
            <label class="homey-form-label" for="password">Passord</label>
            <input class="homey-form-input" id="password" type="password" value="" />
        </div>
        <div class="homey-form-group">
            <button class="homey-button homey-button-primary" id="loginButton" type="button">Login</button>
    </fieldset>
</form>
<script type="application/javascript">
    Homey.setTitle(Homey.__("Polestar 2"));

    $('#loginButton').click(function () {
        Homey.showLoadingOverlay();
        var loginData = {
            email: $('#email').val(),
            password: $('#password').val()
        };
        Homey.emit('login', loginData).then(function (result) {
            Homey.hideLoadingOverlay();
            console.log(result);
            if (result.error) {
                console.log('Login failed');
                Homey.alert('Login failed. Please check your credentials and try again.');
                return Homey.setNavigationClose();
            } else {
                console.log("Tibber login successful");
                return Homey.nextView();
            }
        });
    });
</script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>